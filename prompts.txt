Role: Senior Full-Stack Architect (Python/LangGraph & Electron/React) Project Context: We are in the process of migrating "Pulse" (an Agentic AI IDE) from a pure Python/Flet application to a Commercial-Grade Hybrid App.

Original State (Legacy): A monolithic Python application using Flet for the UI.
Current State (Migration):
Backend: The original Python Agent logic (src/agents/, src/tools/) has been wrapped in a FastAPI/WebSocket Server (likely in src/server/ or similar).
Frontend: A new Electron + React + Monaco Editor application communicating with the backend via localhost.
Constraint: You MUST NOT modify or break any files related to the original Flet implementation (e.g., src/ui/flet_app.py, main.py etc.). The Flet app is our stable fallback and must remain untouched.
The Mission: I have connected the Frontend to the Backend, but the application is non-functional in critical areas. You need to perform a "Deep Dive" debugging session to fix the following high-priority issues step-by-step.

Phase 1: Architectural Analysis (Answer These First)
Before writing code, analyze the codebase (src/server, src/agents, electron/) and answer these questions to clarify the implementation model:

API Key Authority: Does the new Server use the .env file or the Settings passed from the Electron UI's user input for LLM calls? Verify the SettingsManager logic in the API layer.
Logic Encapsulation: verify if new LangGraph functions were implemented, or if the original Flet-based Agent logic was simply wrapped in an API? (Ideally, it should be the latter).
Tool Execution Flow: How are LangGraph tool calls handling "Approval" events (like Terminal/Patch permissions)? Are they still trying to trigger Flet UI modals, or are they effectively emitting JSON events over the WebSocket?
File Inventory: List exactly which files belong to the Flet Implementation (Touch ONLY if shared core logic requires it) and which belong to the Electron Implementation.
Phase 2: "Ultra-Think" & Execution (Fix These Step-by-Step)
Issue 1: The Silent Agent (CRITICAL)

Symptoms: WebSocket connects, but sending a message yields no Agent response. No tools fire, no LangGraph events return.
Hypothesis to Investigate:
Is the server correctly creating a thread_id for LangGraph persistence?
Are the await calls in the WebSocket loop actually waiting for the synchronous/async LangGraph generator?
Is the EventBus (designed for Flet) correctly bridged to the WebSocket broadcaster?
Action: Trace the message flow from ws_endpoint -> master_graph.invoke -> WebSocket Response. Fix the broken link.
Issue 2: Monaco Editor Layout & Styling

Symptoms: Black bars on sides, missing line numbers, content overlapping/rendering poorly.
Action: The React layout is likely using incorrect CSS height/width constraints. Implement a proper Flexbox/Grid container for the MonacoEditor component. Ensure automaticLayout={true} is set and the parent container has explicit dimensions.
Issue 3: Functional Terminal Integration

Symptoms: Terminal is dead/static. Also getting error: 
Failed to resolve import "@xterm/addon-web-links" from "src/components/terminal/TerminalPanel.tsx". Does the file exist?
C:/Users/katha/OneDrive - The Pennsylvania State University/Documents/Projects/Pulse/pulse-electron/src/components/terminal/TerminalPanel.tsx:11:30
19 |  import { Terminal } from "@xterm/xterm";
20 |  import { FitAddon } from "@xterm/addon-fit";
21 |  import { WebLinksAddon } from "@xterm/addon-web-links";
   |                                 ^
22 |  import "@xterm/xterm/css/xterm.css";
23 |  import { useUIStore } from "@/stores/uiStore";


Action: The Flet app used a Python-side terminal. For Electron, we need a native solution. Implement xterm.js in the React frontend and node-pty in the Electron Main process to spawn a real interactive shell (PowerShell/Bash) that pipes data to the UI.
Issue 4: File Explorer Capabilities

Symptoms: Cannot create files/folders via UI.
Action: Implement context menus (Right-Click) in the React File Tree. Bind these actions to the src/server file system API (or Electron's ipcRenderer.invoke('fs:create') if using local Node calls). Align behavior with VS Code standards.
Execution Rules:

Think before you edit. Explain the root cause of the Agent silence before fixing it.
Isolate your changes. Work primarily in src/server/ and the electron/ or frontend/ folders.
Preserve the Flet code.